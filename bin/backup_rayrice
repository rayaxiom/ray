#!/bin/bash

## Telling them!
echo "I ran $0 on $(date +"%F at %T")"

## Get the username
cd ~/ray/userdata/
USERNAME=$(<username)

source ~/ray/userdata/bkdirs_${USERNAME}${HOSTNAME}

## Back up each file/folder in bk_dirs
for i in "${bkdirs[@]}"
do
  echo "************************************************************"
  echo "Backing up $i"
  rdiff-backup --print-statistics ~/$i $BKPATH/$i
  
  echo "Deleting files older than 4 weeks from $i"
  rdiff-backup --remove-older-than 4W $BKPATH/$i
done

## Now output the collective space used.
## Commented out since it is read intensive
#echo "************************************************************"
#echo "Hdd used for $BKPATH"
#du -chs $BKPATH

## Change to home directory
#cd
#echo "Memory of current data:"
#du -chs "${bkdirs[@]}"


